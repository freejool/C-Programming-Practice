## 《第一章 文章单词统计》

 

### 一、英文文件单词词频统计

#### **实验要求：英文文件单词词频统计**

对一个英文文件中所有单词的词频进行统计，并将统计结果保存到文件中。

- 单词表使用单链表

- 链表空间在程序结束前要删除，不得造成内存泄漏

- 按单词出现次数从高到低排序

- 能正确统计不同单词及其出现的次数，忽略大小写

- 能过滤掉停用词

- 能输出链表内容到输出文件，格式规范 

- 能用命令行参数形式

- 对一个英文文件中所有单词的词频进行统计，并将统计结果保存到文件中

#### 输入样例：

命令行

Wordsplit paper.txt result.txt

 

#### 输出样例：

```
"topological" is the most used word in this article, 13 times.
Done!
```

##### Result.txt

```
#    word                          frequency  percentage
1    topological                   13         2.87%
2    quantum                       5          1.10%
3    chapter                       5          1.10%
4    polarized                     4          0.88%
5    light                         4          0.88%
6    spin                          4          0.88%
7    which                         4          0.88%
8    under                         3          0.66%
9    two                           3          0.66%
10   first                         3          0.66%
11   off-resonant                  3          0.66%
12   circularly                    3          0.66%
13   phase                         3          0.66%
14   transition                    3          0.66%
15   pumping                       3          0.66%
16   effect                        3          0.66%
17   give                          3          0.66%
18   band                          3          0.66%
19   theory                        3          0.66%
20   study                         3          0.66%
21   model                         3          0.66%
22   hamiltonian                   3          0.66%
23   derive                        3          0.66%
24   form                          3          0.66%
25   theoretical                   3          0.66%
26   hall                          3          0.66%
27   phases                        2          0.44%
28   transport                     2          0.44%
29   phenomena                     2          0.44%
30   thesis                        2          0.44%
31   contains                      2          0.44%
32   topic                         2          0.44%
33   realize                       2          0.44%
34   second                        2          0.44%
35   find                          2          0.44%
36   two-dimensional               2          0.44%
37   electrically                  2          0.44%
38   modulated                     2          0.44%
39   adiabatic                     2          0.44%
40   cycles                        2          0.44%
41   insulators                    2          0.44%
42   symmetry                      2          0.44%
43   then                          2          0.44%
44   about                         2          0.44%
45   bernevig-hughs-zhang          2          0.44%
46   also                          2          0.44%
47   using                         2          0.44%
48   charge                        2          0.44%
49   conductivity                  2          0.44%
50   framework                     2          0.44%
51   longitudinal                  2          0.44%
52   conductivities                2          0.44%
53   when                          2          0.44%
54   fermi                         2          0.44%
55   level                         2          0.44%
56   discovery                     2          0.44%
57   electrode                     2          0.44%
58   great                         1          0.22%
59   attention                     1          0.22%
60   paid                          1          0.22%
61   condensed                     1          0.22%
62   matter                        1          0.22%
63   system                        1          0.22%
64   time                          1          0.22%
65   periodic                      1          0.22%
66   driving                       1          0.22%
67   over                          1          0.22%
68   past                          1          0.22%
69   few                           1          0.22%
70   years                         1          0.22%
71   mainly                        1          0.22%
72   topics                        1          0.22%
73   propose                       1          0.22%
74   use                           1          0.22%
75   dimensional                   1          0.22%
76   insulator                     1          0.22%
77   theoretically                 1          0.22%
78   tt                            1          0.22%
79   organized                     1          0.22%
80   follows                       1          0.22%
81   brief                         1          0.22%
82   introduction                  1          0.22%
83   extended                      1          0.22%
84   concept                       1          0.22%
85   named                         1          0.22%
86   protected                     1          0.22%
87   introduce                     1          0.22%
88   developed                     1          0.22%
89   berry                         1          0.22%
90   curvature                     1          0.22%
91   two-band                      1          0.22%
92   calculated                    1          0.22%
93   argument                      1          0.22%
94   intrinsic                     1          0.22%
95   spin-orbit                    1          0.22%
96   coupling                      1          0.22%
97   graphene                      1          0.22%
98   lattice                       1          0.22%
99   quantization                  1          0.22%
100  kane-mele                     1          0.22%
101  experiment                    1          0.22%
102  realization                   1          0.22%
103  introduced                    1          0.22%
104  briefly                       1          0.22%
105  end                           1          0.22%
106  keyldsh                       1          0.22%
107  green's                       1          0.22%
108  function                      1          0.22%
109  linear                        1          0.22%
110  response                      1          0.22%
111  path                          1          0.22%
112  integral                      1          0.22%
113  formulism                     1          0.22%
114  tensor                        1          0.22%
115  prove                         1          0.22%
116  relation                      1          0.22%
117  between                       1          0.22%
118  invariant                     1          0.22%
119  zero                          1          0.22%
120  temperature                   1          0.22%
121  three                         1          0.22%
122  floquet                       1          0.22%
123  effective                     1          0.22%
124  approximation                 1          0.22%
125  derived                       1          0.22%
126  applying                      1          0.22%
127  effectively                   1          0.22%
128  creates                       1          0.22%
129  zeeman                        1          0.22%
130  exchange                      1          0.22%
131  field                         1          0.22%
132  renormalized                  1          0.22%
133  dirac                         1          0.22%
134  mass                          1          0.22%
135  tunable                       1          0.22%
136  varying                       1          0.22%
137  intensity                     1          0.22%
138  drive                         1          0.22%
139  provides                      1          0.22%
140  alternative                   1          0.22%
141  method                        1          0.22%
142  anomalous                     1          0.22%
143  other                         1          0.22%
144  magnetic                      1          0.22%
145  doping                        1          0.22%
146  both                          1          0.22%
147  transverse                    1          0.22%
148  studied                       1          0.22%
149  former                        1          0.22%
150  consistent                    1          0.22%
151  lies                          1          0.22%
152  gap                           1          0.22%
153  highly                        1          0.22%
154  controllable                  1          0.22%
155  spin-polarized                1          0.22%
156  electrical                    1          0.22%
157  current                       1          0.22%
158  generated                     1          0.22%
159  conduction                    1          0.22%
160  may                           1          0.22%
161  useful                        1          0.22%
162  designing                     1          0.22%
163  spintronics                   1          0.22%
164  four                          1          0.22%
165  report                        1          0.22%
166  bulk                          1          0.22%
167  ti                            1          0.22%
168  each                          1          0.22%
169  cycle                         1          0.22%
170  amount                        1          0.22%
171  proportional                  1          0.22%
172  sample                        1          0.22%
173  width                         1          0.22%
174  pumped                        1          0.22%
175  into                          1          0.22%
176  nonmagnetic                   1          0.22%
177  attributed                    1          0.22%
178  nonzero                       1          0.22%
179  chern                         1          0.22%
180  numbers                       1          0.22%
181  moreover                      1          0.22%
182  half-metallic                 1          0.22%
183  universal                     1          0.22%
184  quantized                     1          0.22%
185  measured                      1          0.22%
186  paves                         1          0.22%
187  way                           1          0.22%
188  direct                        1          0.22%
189  utilization                   1          0.22%
190  robust                        1          0.22%
191  properties                    1          0.22%
192  tls                           1          0.22%
193  final                         1          0.22%
194  section                       1          0.22%
195  summary                       1          0.22%

 453 words

```

##### Wordsplit.h

```c
//
// Created by Sxing on 03/07/2021.
//

#ifndef INC_1__WORDSPLIT_H
#define INC_1__WORDSPLIT_H

#endif //INC_1__WORDSPLIT_H


#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define lenOfWord 40
#define numOfRem 24 //num of removing word
#define numOfPunc 4

const char rem[][lenOfWord] = {"with", "in", "one", "we", "a", "to", "and", "an", "has", "been", "the", "this", "is",
                               "as", "that", "for", "be", "can", "than", "are", "by", "at", "of", "from"};
const char punctuation[numOfPunc] = ",.?!";


typedef enum {
    false, true
} bool;

typedef struct node {
    char word[lenOfWord];
    unsigned int freq;
    double cent;
    struct node *next;
} node, *pnode;

typedef struct linkedList {
    pnode head;
    unsigned int count;
    //int maxLen;
} linkedList;

pnode locate(linkedList *L, char ch[]) {
    pnode p = L->head;
    while (p != NULL) {
        if (strcmp(p->word, ch) == 0) {
            return p;
        }
        p = p->next;
    }
    return NULL;
} //return NULL when not found, location when found

bool isRem(char ch[]) {
    bool isRem = false;
    for (int i = 0; i < numOfRem;
         i++) {
        if (strcmp(ch, rem[i]) == 0) {
            isRem = true;
            break;
        }
    }
    return isRem;
}

//Punctuation
void deCasePunc(char *ch) {
    for (int i = 0; i < strlen(ch); i++)
        if (ch[i] >= 65 && ch[i] <= 90) {
            ch[i] += 32;
        }
    char *lastC = &ch[strlen(ch) - 1];
    for (int i = 0; i < numOfPunc; i++) {
        if (*lastC == punctuation[i]) {
            *lastC = '\0';
            break;
        }
    }
}

void addEnd(pnode pTail, char ch[]) {
    pTail->next = (pnode) malloc(sizeof(node));
    if (pTail->next == NULL) {
        printf("ERROR! Out of memory!\n");
        exit(-1);
    }
    strcpy(pTail->next->word, ch);
    pTail->next->freq = 1;
    pTail->next->next = NULL;
}

void initLlist(linkedList *L, FILE *fpR) {
    L->head = (pnode) malloc(sizeof(node));
    if (L->head == NULL) {
        printf("ERROR! Out of memory!\n");
        exit(-1);
    }
    L->head->word[0] = '\0';
    L->head->freq = 0;
    L->head->next = NULL;
    L->count = 0;
    char ch[40];
    pnode pTail = L->head;
    pnode p;
    fscanf(fpR, "%s", ch);
    deCasePunc(ch);//lowercase and del punc
    while (!feof(fpR)) { //throughout file
        L->count++;
        if (isRem(ch) == false) {//remove common words
            p = locate(L, ch);
            if (p == NULL) {//ch not found in L
                addEnd(pTail, ch);
                pTail = pTail->next;
            } else { //ch found at p in L
                p->freq++;
            }
        }
        fscanf(fpR, "%s", ch);
        deCasePunc(ch);
    }
    p = L->head->next;
    while (p != NULL) {
        p->cent = (double) p->freq / (double) L->count * 100;
        p = p->next;
    }
}

void sort(linkedList *L) { //applying bubble sort
    int num = 0;
    int j;
    pnode p, q;
    q = L->head;
    while (q->next != NULL) {
        q = q->next;
        num++;
    }
    for (int i = 0; i < num - 1; i++) {
        p = L->head->next;
        q = L->head;
        j = num - i - 1;
        while (p->next != NULL && j != 0) {
            j--;
            if (p->freq < p->next->freq) {
                q->next = p->next;
                q = p->next;
                p->next = q->next;
                q->next = p;
                p = q;//cuz p was repointed
            }
            q = p;
            p = p->next;//q is the prevNode of p
        }
    }
}


void printList(linkedList L, FILE *fpW) {
    if (L.head->next == NULL) {
        printf("ERROR! INFO is empty!\n");
    } else {
        int i = 1;
        fprintf(fpW, "#    word                          frequency  percentage\n");
        pnode p = L.head->next;
        while (p != NULL) {
            fprintf(fpW, "%-5d%-30s%-11d%.2f%%\n", i, p->word, p->freq, p->cent);
            p = p->next;
            i++;
        }
    }
    fprintf(fpW, "\n %d words\n", L.count);
    printf("\"%s\" is the most used word in this article, %d times.\n", L.head->next->word, L.head->next->freq);
}

void linkFree(linkedList *L) {
    pnode tmp;
    pnode head = L->head;
    while (head != NULL) {
        tmp = head;
        head = head->next;
        free(tmp);
    }
}

```

##### Wordsplit.c

```c
//
// Created by Sxing on 03/07/2021.
//

#include "wordsplit.h"

/*
 * usage:
 *  gcc ./wordsplit.c
 *  ./a.out input_file_name output_file_name
 */
int main(int argc, char *argv[]) {
    setbuf(stdout, NULL);
    char inFilename[255];
    char outFilename[255];
    FILE *fpR;//read pointer
    FILE *fpW;//write pointer
    if (argc > 3) {
        printf("Too many parameters.\n");
        return -1;
    } else if (argc < 3) {
        printf("Too few parameters.\n");
        return -1;
    } else {
        strcpy(inFilename, argv[1]);
        strcpy(outFilename, argv[2]);
    }
    if ((fpR = fopen(inFilename, "r")) == NULL) {
        printf("ERROR! Failed to read!");
        return -1;
    }
    if ((fpW = fopen(outFilename, "w+")) == NULL) {
        printf("ERROR! Failed to write!");
        return -1;
    }

    linkedList info;
    initLlist(&info, fpR);//initialize INFO
    sort(&info);//sort and count
    printList(info, fpW);//output data into assigned file

    linkFree(&info);//Free memory
    fclose(fpR);
    fclose(fpW);
    printf("Done!\n");
    return 0;
}

```

